<!-- LISA's CODE -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <title>Document</title>
</head>
<body>
    <br>
    <h1>Eventbeats Project Template</h1>
    <br>
    <div id="resetButton">
        <button data-reset="1">Reset</button>
    </div>
    <br>
    <div id="peopleSearch">
        <form id="people-form">
            <label for="people-input">Search a band!</label>
            <input type="text" id="people-input"><br>
            <br>
            <!-- Button triggers new movie to be added -->
            <input id="add-people" type="submit" value="Search">
        </form>
    </div>
    <div id="gifsGoHere"></div>


<script type="text/javascript">

/////// GABE's CODE//////////////
    $("#add-people").on("click", function(event){
        event.preventDefault();

        var bandQuery = $("#people-input").val().trim();

        var queryURL = "https://api.songkick.com/api/3.0/search/artists.json?apikey=" + API_KEY + "&query=" + bandQuery;

        //pulls band ID

            $.ajax({
                    url: queryURL,
                    method: "GET", 
                }).then(function(response){

                    var bandID = response.resultsPage.results.artist[0].id;
        
        
            //function takes ID from API
            function eventData(apiID){
                var newQueryURL = 
                "https://api.songkick.com/api/3.0/artists/"+ apiID +"/calendar.json?apikey=" + API_KEY+"&per_page=10";

            //pull event data using bandID from previous pull
                $.ajax({
                    url: newQueryURL,
                    method: "GET",
                }).then(function(response){

                    console.log(response);

                    var eventArr = response.resultsPage.results.event;
                // loop through events array to get information for first 10 results
                //will add more functionality after group meeting tomorrow 2/5/2019
                    for (var i=0; i<eventArr.length; i++){

                        console.log(eventArr[i]);

                    }

                });
            }
            // calls eventData function passing in the bandID
            eventData(bandID); 
        });
    });
    




    ////////// LISA's CODE///////////////




        var API_KEY = "SrukemE16v6dIJlj";
        var buttonHandler = function () {
            if ($(this).data("reset") == "1") {
                //  $('#gifsGoHere').html("");
                //  console.log("Cleared")
                window.location.reload();
                return;
            }
            var personName = $(this).data("people");
            console.log(personName);
            var queryURL = "https://api.songkick.com/api/3.0/search/artists.json?apikey=" + API_KEY + "&query=" + encodeURIComponent(personName);
            $.ajax({
                    url: queryURL,
                    method: "GET", 
                })
                .done(function (response) {
                    console.log(response);
                    for (var i = 0; i < response.data.length; i++) {
                        var animalDiv = $('<div>');
                        var p = $('<p>').text("Event Info " + response.data[i].rating);
                        var animalImage = $('<img>');
                        animalImage.attr('src', response.data[i].images.fixed_height.url);
                        animalDiv.append(p);
                        animalDiv.append(animalImage);
                        $('#gifsGoHere').append(animalDiv);
                    }
                })
        };
        $('button').on('click', buttonHandler);
        $("#add-people").on("click", function (event) {
            event.preventDefault();
            // Then dynamicaly generating buttons for each movie in the array.
            // This code $("<button>") is all jQuery needs to create the start and end tag. (<button></button>)
            var people = $("#people-input").val().trim();
            var button = $("<button>");
            // Adding a class
            // a.addClass("people");
            // Adding a data-attribute with a value of the movie at index i
            button.attr("data-people", people);
            // Providing the button's text with a value of the movie at index i
            button.text(people);
            // Adding the button to the HTML
            $("#buttonsGoHere").append(button);
            button.on("click", buttonHandler);
        });
    

        </script>
    </body>
</html>

